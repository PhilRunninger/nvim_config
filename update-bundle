#!/bin/sh

set -e

echo "▶ PULLING SUBMODULES ━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-"
git submodule --quiet foreach '
    echo $name
    BRANCH=$(git config -f $toplevel/.gitmodules submodule."$path".branch || echo master)
    git checkout --quiet $BRANCH
    OLDHASH=$(git rev-parse HEAD)
    git pull --quiet --recurse-submodules || :
    git log --oneline $OLDHASH..HEAD
'

echo "▶ UPDATING HELP TAGS ━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-━-"
nvim -u NONE -N --headless -c "helptags ALL" -c "qa!"
